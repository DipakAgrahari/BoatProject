let express = require('express');
let router = express.Router();

const BusinessModel= require('../models/owner')
const authMiddleware=require('../middlewares/auth')

router.post("/addUpdateBoat",authMiddleware, (req, res) => {
    console.log(req.user)
    
    var newBoat = {
        BoatID: req.body.BoatID,
        BoatName:req.body.BoatName,
        Type:req.body.Type,
        NoOfRooms:req.body.NoOfRooms,
        NoOfBedrooms:req.body.NoOfBedrooms,
        CostPerNight:req.body.CostPerNight,
        ImageURL:req.body.ImageURL,
        Classification:req.body.Classification,
        Verified:req.body.Verified
    }
    
    // {
    //     "OwnerId":111,
    //     "BoatID": 555,
    //     "BoatName":"ABC",
    //     "Type":"ABC",
    //     "NoOfRooms":2,
    //     "NoOfBedrooms":2,
    //     "CostPerNight":"Rs 2000",
    //     "ImageURL":"ABC/ABC/ABC",
    //     "Classification":"ABC",
    //     "Verified":true
    // }
    
    BusinessModel.findOne({ OwnerId: req.user.OwnerId }).then((result) => {  //Will work after code change by dipak
        var boatArray = result.Boats
        boatArray = [...boatArray, newBoat]
        console.log(boatArray)
    
        var update = {
            $set: {
                Boats: boatArray
            }
        }
    
        BusinessModel.findOneAndUpdate({ OwnerId: req.user.OwnerId }, update).then((result) => {
            console.log(result)
            res.status(200).json({
                message:"db updated",
                status:"Success"
            })
        })
    })
})

module.exports = router;